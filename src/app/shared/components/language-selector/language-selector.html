<div class="language">
  <button 
    class="language-btn" 
    (click)="toggleDropdown($event)"
    [class.active]="isOpen"
    [attr.aria-expanded]="isOpen"
    aria-label="Selecionar idioma"
  >
    <div class="flag-container">
      <img 
        class="flag-img" 
        [src]="getCurrentLanguage().flag" 
        [alt]="getCurrentLanguage().shortName"
        (error)="onFlagError($event)"
      />
    </div>

    <span class="language-name">
      {{ getLanguageText() }}
    </span>
  </button>

  <ul 
    class="language-dropdown"
    [class.open]="isOpen"
    aria-label="Opções de idioma"
    (click)="$event.stopPropagation()"
  >
    <li 
      *ngFor="let lang of languages" 
      [class.active]="currentLang === lang.code"
      (click)="selectLanguage(lang)"
      tabindex="0"
      role="menuitem"
    >
      <div class="flag-container">
        <img 
          class="flag-img" 
          [src]="lang.flag" 
          [alt]="lang.shortName"
          (error)="onFlagError($event)"
        />
      </div>
      <span class="language-name">
        {{ lang.name }}
      </span>
    </li>
  </ul>
</div>
